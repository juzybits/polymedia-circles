<!DOCTYPE html>
<html>
<head>
    <title>Polymedia Circles</title>
</head>
<body>

<script>

const CANVAS_SIZE = 1000;
const CIRCLE_MIN_RADIUS = 42;
const CIRCLE_MAX_RADIUS = 420
const MIN_CIRCLES = 2;
const MAX_CIRCLES = 5;

// Generate a random integer between `min` (inclusive) and `max` (exclusive)
function getRandomNumber(min, max) {
    return Math.floor(Math.random() * (max - min) + min);
}

// Generate a random CSS color like "rgb(35,123,207)"
function getRandomColor() {
    // const red = getRandomNumber(0, 256);
    // const red = getRandomNumber(0, 26) * 10;
    // const red = getRandomNumber(0, 11) * 25;
    // const red = getRandomNumber(4, 11) * 25;
    const red = 7 + getRandomNumber(3, 9) * 31;
    // const green = getRandomNumber(0, 256);
    // const green = getRandomNumber(0, 26) * 10;
    // const green = getRandomNumber(0, 11) * 25;
    // const green = getRandomNumber(4, 11) * 25;
    const green = 7 + getRandomNumber(3, 9) * 31;
    // const blue = getRandomNumber(0, 256);
    // const blue = getRandomNumber(0, 26) * 10;
    // const blue = getRandomNumber(0, 11) * 25;
    // const blue = getRandomNumber(4, 11) * 25;
    const blue = 7 + getRandomNumber(3, 9) * 31;
    return `rgb(${red},${green},${blue})`;
}

// Random background color
const backgroundColor = getRandomColor();

// Random number of circles
const numCircles = getRandomNumber(MIN_CIRCLES, MAX_CIRCLES+1);

const circlesConfig = [];

// Generate properties for each circle
for (let i = 0; i < numCircles; i++) {
    const radius = getRandomNumber(CIRCLE_MIN_RADIUS, CIRCLE_MAX_RADIUS+1); // Random radius
    circlesConfig.push({
        color: getRandomColor(),
        radius: radius,
        cx: getRandomNumber(radius/2, CANVAS_SIZE - radius/2), // Random x position
        cy: getRandomNumber(radius/2, CANVAS_SIZE - radius/2) // Random y position
    });
}

console.log("Background color: ", backgroundColor);
console.log("Number of circles: ", numCircles);
console.log("Circle properties: ", JSON.stringify(circlesConfig, null, 2));

// Paint the SVG

// First, create the SVG and rect elements
const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
svg.setAttribute("width", CANVAS_SIZE);
svg.setAttribute("height", CANVAS_SIZE);

const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
rect.setAttribute("width", "100%");
rect.setAttribute("height", "100%");
rect.setAttribute("fill", backgroundColor);
svg.appendChild(rect);

// Sort the config array by circle radius (in descending order)
circlesConfig.sort((a, b) => b.radius - a.radius);

// Then create and append each circle
circlesConfig.forEach(function(circleConfig) {
    const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
    circle.setAttribute("cx", circleConfig.cx);
    circle.setAttribute("cy", circleConfig.cy);
    circle.setAttribute("r", circleConfig.radius);
    circle.setAttribute("fill", circleConfig.color);
    circle.setAttribute("stroke", "black");
    circle.setAttribute("stroke-width", "4");
    svg.appendChild(circle);
});

const footer = document.createElementNS("http://www.w3.org/2000/svg", "text");
footer.setAttribute("x", CANVAS_SIZE - 8); // Near the right edge
footer.setAttribute("y", CANVAS_SIZE - 11); // Near the bottom edge
footer.setAttribute("font-family", "monospace");
footer.setAttribute("font-size", "20");
footer.setAttribute("fill", "white");
footer.setAttribute("text-anchor", "end");
footer.textContent = "Polymedia Circles #" + getRandomNumber(0, 10000);
svg.appendChild(footer);

// Create a black frame
const frame = document.createElementNS("http://www.w3.org/2000/svg", "rect");
frame.setAttribute("width", "100%");
frame.setAttribute("height", "100%");
frame.setAttribute("fill", "none");
frame.setAttribute("stroke", "black");
frame.setAttribute("stroke-width", "8");
svg.appendChild(frame);

/*
// Create an anchor element and set its href attribute
const link = document.createElementNS("http://www.w3.org/2000/svg", "a");
link.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", "https://circles.polymedia.app/view/1234");
// Append the text element to the anchor element
link.appendChild(footer);
// Append the anchor element to the svg element
svg.appendChild(link);
*/

// Append the SVG to the body (or any other container element)
document.body.appendChild(svg);

/*
const COLORS = [
    '#f94144ff', // imperial-red
    '#ff6600ff', // pumpkin
    '#ff9900ff', // orange-peel
    '#f9c74fff', // saffron
    '#ffcc00ff', // jonquil
    '#ccee66ff', // mindaro
    '#99cc33ff', // yellow-green
    '#90be6dff', // pistachio
    '#43aa8bff', // zomp
    '#006699ff', // lapis-lazuli
    '#3399ccff', // celestial-blue
    '#277da1ff', // cerulean
    '#990066ff', // murrey
    '#cc3399ff', // red-violet

];

// Selects a random color from the COLORS array
function getRandomColor() {
    const index = getRandomNumber(0, COLORS.length);
    return COLORS[index];
}

// Fisher-Yates (aka Knuth) Shuffle algorithm to shuffle array
function shuffleArray(array) {
    let currentIndex = array.length, temporaryValue, randomIndex;

    // While there remain elements to shuffle...
    while (0 !== currentIndex) {
        // Pick a remaining element...
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex -= 1;

        // And swap it with the current element.
        temporaryValue = array[currentIndex];
        array[currentIndex] = array[randomIndex];
        array[randomIndex] = temporaryValue;
    }

    return array;
}

// Shuffle the colors array
shuffleArray(COLORS);

// A counter for the color array
let colorIndex = 0;

// Selects a color from the COLORS array in order
function getRandomColorUnique() {
    // Return the current color and increment the index
    return COLORS[colorIndex++];
}
*/

</script>

</body>
</html>

<!-- Example output:
<svg width="1000" height="1000" xmlns="http://www.w3.org/2000/svg">
   <rect width="100%" height="100%" fill="rgb(255,162,100)" />
   <circle cx="543" cy="465" r="260" fill="rgb(224,224,193)" stroke="black" stroke-width="4" />
   <circle cx="139" cy="402" r="204" fill="rgb(131,162,224)" stroke="black" stroke-width="4" />
   <circle cx="410" cy="632" r="141" fill="rgb(255,100,131)" stroke="black" stroke-width="4" />
   <text x="992" y="989" font-family="monospace" font-size="20" fill="white" text-anchor="end">Polymedia Circles #1234</text>
   <rect width="100%" height="100%" fill="none" stroke="black" stroke-width="8" />
</svg>
-->
