<!DOCTYPE html>
<html>
<head>
    <title>Polymedia Circles</title>
</head>
<body>

<script>

const CANVAS_SIZE = 1000;
const CIRCLE_MIN_RADIUS = 42;
const CIRCLE_MAX_RADIUS = 420
const MIN_CIRCLES = 2;
const MAX_CIRCLES = 5;

// Generate a random integer between `min` (inclusive) and `max` (exclusive)
function getRandomNumber(min, max) {
    return Math.floor(Math.random() * (max - min) + min);
}

// Generate a random CSS color like "rgb(35,123,207)"
function getRandomColor() {
    // const red = getRandomNumber(0, 256);
    // const red = getRandomNumber(0, 26) * 10;
    // const red = getRandomNumber(0, 11) * 25;
    const red = getRandomNumber(0, 6) * 50;
    // const green = getRandomNumber(0, 256);
    // const green = getRandomNumber(0, 26) * 10;
    // const green = getRandomNumber(0, 11) * 25;
    const green = getRandomNumber(0, 6) * 50;
    // const blue = getRandomNumber(0, 256);
    // const blue = getRandomNumber(0, 26) * 10;
    // const blue = getRandomNumber(0, 11) * 25;
    const blue = getRandomNumber(0, 6) * 50;
    return `rgb(${red},${green},${blue})`;
}

// Random background color
const backgroundColor = getRandomColor();

// Random number of circles
const numCircles = getRandomNumber(MIN_CIRCLES, MAX_CIRCLES+1);

const circlesConfig = [];

// Generate properties for each circle
for (let i = 0; i < numCircles; i++) {
    const radius = getRandomNumber(CIRCLE_MIN_RADIUS, CIRCLE_MAX_RADIUS+1); // Random radius
    circlesConfig.push({
        color: getRandomColor(),
        radius: radius,
        cx: getRandomNumber(radius/2, CANVAS_SIZE - radius/2), // Random x position
        cy: getRandomNumber(radius/2, CANVAS_SIZE - radius/2) // Random y position
    });
}

console.log("Background color: ", backgroundColor);
console.log("Number of circles: ", numCircles);
console.log("Circle properties: ", JSON.stringify(circlesConfig, null, 2));

// Paint the SVG

// First, create the SVG and rect elements
const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
svg.setAttribute("width", CANVAS_SIZE);
svg.setAttribute("height", CANVAS_SIZE);

const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
rect.setAttribute("width", "100%");
rect.setAttribute("height", "100%");
rect.setAttribute("fill", backgroundColor);
svg.appendChild(rect);

// Sort the config array by circle radius (in descending order)
circlesConfig.sort((a, b) => b.radius - a.radius);

// Then create and append each circle
circlesConfig.forEach(function(circleConfig) {
    const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
    circle.setAttribute("cx", circleConfig.cx);
    circle.setAttribute("cy", circleConfig.cy);
    circle.setAttribute("r", circleConfig.radius);
    circle.setAttribute("fill", circleConfig.color);
    svg.appendChild(circle);
});

const footer = document.createElementNS("http://www.w3.org/2000/svg", "text");
footer.setAttribute("x", CANVAS_SIZE - 8); // Near the right edge
footer.setAttribute("y", CANVAS_SIZE - 10); // Near the bottom edge
footer.setAttribute("font-family", "monospace");
footer.setAttribute("font-size", "20");
footer.setAttribute("fill", "white");
footer.setAttribute("text-anchor", "end");
footer.textContent = "Polymedia Circles #" + getRandomNumber(0, 10000);
svg.appendChild(footer);

/*
// Create an anchor element and set its href attribute
const link = document.createElementNS("http://www.w3.org/2000/svg", "a");
link.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", "https://circles.polymedia.app/view/1234");
// Append the text element to the anchor element
link.appendChild(footer);
// Append the anchor element to the svg element
svg.appendChild(link);
*/

// Append the SVG to the body (or any other container element)
document.body.appendChild(svg);

</script>

</body>
</html>

<!--
<svg width="1000" height="1000" xmlns="http://www.w3.org/2000/svg">
   <rect width="100%" height="100%" fill="#341F79" />
   <circle r="177" cx="466" cy="342" fill="#557367" />
   <circle r="165" cx="370" cy="379" fill="#D06D1B" />
   <circle r="108" cx="421" cy="617" fill="#B441C1" />
   <circle r="106" cx="576" cy="552" fill="#039DFB" />
   <circle r="69" cx="496" cy="319" fill="#855389" />
   <text x="992" y="990" font-family="monospace" font-size="20" fill="white" text-anchor="end">Polymedia Circles #1234</text>
</svg>
-->